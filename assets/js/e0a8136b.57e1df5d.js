"use strict";(globalThis.webpackChunkhumanoid_robotics_book=globalThis.webpackChunkhumanoid_robotics_book||[]).push([[4871],{163(n,e,i){i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var o=i(4848),t=i(8453);const r={},s="Gazebo Simulation Integration with ROS 2",a={id:"module-2-digital-twin/gazebo-integration",title:"Gazebo Simulation Integration with ROS 2",description:"Overview",source:"@site/docs/module-2-digital-twin/gazebo-integration.mdx",sourceDirName:"module-2-digital-twin",slug:"/module-2-digital-twin/gazebo-integration",permalink:"/Physical-AI-Humanoid-Robotics-Book/docs/module-2-digital-twin/gazebo-integration",draft:!1,unlisted:!1,editUrl:"https://github.com/Asim1112/Physical-AI-Humanoid-Robotics-Book/edit/main/frontend/docs/module-2-digital-twin/gazebo-integration.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ROS 2 Integration",permalink:"/Physical-AI-Humanoid-Robotics-Book/docs/module-2-digital-twin/ros2-integration"},next:{title:"Module 2 Exercises: Digital Twin Simulation",permalink:"/Physical-AI-Humanoid-Robotics-Book/docs/module-2-digital-twin/exercises"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Required Components",id:"required-components",level:2},{value:"1. Gazebo Installation",id:"1-gazebo-installation",level:3},{value:"2. Essential ROS 2 Packages",id:"2-essential-ros-2-packages",level:3},{value:"Robot Model Configuration",id:"robot-model-configuration",level:2},{value:"URDF/XACRO Setup",id:"urdfxacro-setup",level:3},{value:"Controller Configuration",id:"controller-configuration",level:3},{value:"Launch File Configuration",id:"launch-file-configuration",level:2},{value:"Sensor Integration",id:"sensor-integration",level:2},{value:"IMU Sensor Configuration",id:"imu-sensor-configuration",level:3},{value:"LiDAR Sensor Configuration",id:"lidar-sensor-configuration",level:3},{value:"Control System Integration",id:"control-system-integration",level:2},{value:"Basic Control Node",id:"basic-control-node",level:3},{value:"Physics Configuration",id:"physics-configuration",level:2},{value:"World File Configuration",id:"world-file-configuration",level:3},{value:"Validation and Testing",id:"validation-and-testing",level:2},{value:"Simulation Validation Node",id:"simulation-validation-node",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"Performance Optimization",id:"performance-optimization",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{id:"gazebo-simulation-integration-with-ros-2",children:"Gazebo Simulation Integration with ROS 2"}),"\n",(0,o.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(e.p,{children:"This guide provides a comprehensive approach to integrating Gazebo simulation with ROS 2 for humanoid robotics applications. The integration enables realistic physics simulation, sensor modeling, and control system development in a safe, repeatable environment."}),"\n",(0,o.jsx)(e.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,o.jsx)(e.p,{children:"The Gazebo-ROS 2 integration follows a plugin-based architecture where Gazebo communicates with ROS 2 through specialized plugins that bridge the simulation and control systems."}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Gazebo       \u2502    \u2502   Gazebo-ROS   \u2502    \u2502   ROS 2         \u2502\n\u2502   Simulation   \u2502\u25c4\u2500\u2500\u25ba\u2502   Bridge       \u2502\u25c4\u2500\u2500\u25ba\u2502   Control &     \u2502\n\u2502                \u2502    \u2502   Plugins      \u2502    \u2502   Perception    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,o.jsx)(e.h2,{id:"required-components",children:"Required Components"}),"\n",(0,o.jsx)(e.h3,{id:"1-gazebo-installation",children:"1. Gazebo Installation"}),"\n",(0,o.jsx)(e.p,{children:"Ensure Gazebo Garden (or compatible version) is installed with ROS 2 support:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"# For Ubuntu 22.04 with ROS 2 Humble\nsudo apt update\nsudo apt install ros-humble-gazebo-ros-pkgs ros-humble-gazebo-ros2-control\n"})}),"\n",(0,o.jsx)(e.h3,{id:"2-essential-ros-2-packages",children:"2. Essential ROS 2 Packages"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"gazebo_ros_pkgs"}),": Core Gazebo-ROS integration"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"gazebo_ros2_control"}),": ROS 2 control system integration"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"ros2_control"}),": Generic control system framework"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"ros2_controllers"}),": Standard controller implementations"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"robot-model-configuration",children:"Robot Model Configuration"}),"\n",(0,o.jsx)(e.h3,{id:"urdfxacro-setup",children:"URDF/XACRO Setup"}),"\n",(0,o.jsx)(e.p,{children:"Create a URDF or XACRO model with proper Gazebo integration tags:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="humanoid_robot">\n\n  \x3c!-- Include Gazebo-specific configurations --\x3e\n  <gazebo>\n    <plugin filename="libgazebo_ros2_control.so" name="gazebo_ros2_control">\n      <parameters>$(find my_robot_description)/config/controllers.yaml</parameters>\n    </plugin>\n  </gazebo>\n\n  \x3c!-- Robot links and joints --\x3e\n  <link name="base_link">\n    <inertial>\n      <mass value="10.0"/>\n      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>\n    </inertial>\n    <visual>\n      <geometry>\n        <box size="0.2 0.2 0.2"/>\n      </geometry>\n    </visual>\n    <collision>\n      <geometry>\n        <box size="0.2 0.2 0.2"/>\n      </geometry>\n    </collision>\n  </link>\n\n  \x3c!-- Example joint with transmission --\x3e\n  <joint name="hip_joint" type="revolute">\n    <parent link="base_link"/>\n    <child link="upper_leg_link"/>\n    <axis xyz="0 0 1"/>\n    <limit lower="-1.57" upper="1.57" effort="100" velocity="3.0"/>\n    <origin xyz="0 0 -0.5"/>\n  </joint>\n\n  <link name="upper_leg_link">\n    <inertial>\n      <mass value="2.0"/>\n      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>\n    </inertial>\n  </link>\n\n  \x3c!-- Transmission for ROS 2 Control --\x3e\n  <transmission name="trans_hip_joint">\n    <type>transmission_interface/SimpleTransmission</type>\n    <joint name="hip_joint">\n      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>\n    </joint>\n    <actuator name="hip_motor">\n      <mechanicalReduction>1</mechanicalReduction>\n    </actuator>\n  </transmission>\n\n</robot>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"controller-configuration",children:"Controller Configuration"}),"\n",(0,o.jsxs)(e.p,{children:["Create a controller configuration file (",(0,o.jsx)(e.code,{children:"config/controllers.yaml"}),"):"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-yaml",children:"controller_manager:\n  ros__parameters:\n    update_rate: 100  # Hz\n\n    joint_state_broadcaster:\n      type: joint_state_broadcaster/JointStateBroadcaster\n\n    # Position controllers for each joint group\n    joint_group_position_controller:\n      type: position_controllers/JointGroupPositionController\n\n    # Individual joint controllers (for more granular control)\n    left_hip_controller:\n      type: position_controllers/JointPositionController\n    right_hip_controller:\n      type: position_controllers/JointPositionController\n    left_knee_controller:\n      type: position_controllers/JointPositionController\n    right_knee_controller:\n      type: position_controllers/JointPositionController\n    # Add controllers for all joints as needed\n\n# Joint group controller configuration\njoint_group_position_controller:\n  ros__parameters:\n    joints:\n      - hip_joint\n      - knee_joint\n      - ankle_joint\n      # Add all joints that should be controlled as a group\n\n# Individual controller configurations\nleft_hip_controller:\n  ros__parameters:\n    joint: left_hip_joint\n    interface_name: position\n\nright_hip_controller:\n  ros__parameters:\n    joint: right_hip_joint\n    interface_name: position\n"})}),"\n",(0,o.jsx)(e.h2,{id:"launch-file-configuration",children:"Launch File Configuration"}),"\n",(0,o.jsx)(e.p,{children:"Create a launch file to start Gazebo with the robot model:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"# launch/gazebo_simulation.launch.py\nimport os\nfrom launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription, DeclareLaunchArgument\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\n\ndef generate_launch_description():\n    # Declare launch arguments\n    use_sim_time = LaunchConfiguration('use_sim_time', default='true')\n    robot_description_path = LaunchConfiguration(\n        'robot_description_path',\n        default=os.path.join(\n            get_package_share_directory('my_robot_description'),\n            'urdf',\n            'humanoid_robot.urdf.xacro'\n        )\n    )\n\n    # Get URDF via xacro\n    robot_description_config = Command([\n        'xacro', ' ', robot_description_path, ' ',\n        'use_sim:=true'\n    ])\n\n    # Robot State Publisher node\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        output='screen',\n        parameters=[{\n            'use_sim_time': use_sim_time,\n            'robot_description': robot_description_config\n        }]\n    )\n\n    # Gazebo launch\n    gazebo = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource([\n            get_package_share_directory('gazebo_ros'),\n            '/launch',\n            '/gazebo.launch.py'\n        ]),\n        launch_arguments={\n            'verbose': 'false',\n            'pause': 'false',\n        }.items()\n    )\n\n    # Spawn robot in Gazebo\n    spawn_entity = Node(\n        package='gazebo_ros',\n        executable='spawn_entity.py',\n        arguments=[\n            '-topic', 'robot_description',\n            '-entity', 'humanoid_robot',\n            '-x', '0.0',\n            '-y', '0.0',\n            '-z', '1.0'\n        ],\n        output='screen'\n    )\n\n    # Load controllers\n    load_joint_state_broadcaster = ExecuteProcess(\n        cmd=['ros2', 'control', 'load_controller', '--set-state', 'start',\n             'joint_state_broadcaster'],\n        output='screen'\n    )\n\n    load_joint_trajectory_controller = ExecuteProcess(\n        cmd=['ros2', 'control', 'load_controller', '--set-state', 'start',\n             'joint_group_position_controller'],\n        output='screen'\n    )\n\n    return LaunchDescription([\n        DeclareLaunchArgument(\n            'use_sim_time',\n            default_value='true',\n            description='Use simulation (Gazebo) clock if true'\n        ),\n        DeclareLaunchArgument(\n            'robot_description_path',\n            default_value=os.path.join(\n                get_package_share_directory('my_robot_description'),\n                'urdf',\n                'humanoid_robot.urdf.xacro'\n            ),\n            description='Absolute path to robot urdf file'\n        ),\n        robot_state_publisher,\n        gazebo,\n        spawn_entity,\n        RegisterEventHandler(\n            OnProcessExit(\n                target_action=spawn_entity,\n                on_exit=[load_joint_state_broadcaster],\n            )\n        ),\n        RegisterEventHandler(\n            OnProcessExit(\n                target_action=load_joint_state_broadcaster,\n                on_exit=[load_joint_trajectory_controller],\n            )\n        ),\n    ])\n"})}),"\n",(0,o.jsx)(e.h2,{id:"sensor-integration",children:"Sensor Integration"}),"\n",(0,o.jsx)(e.h3,{id:"imu-sensor-configuration",children:"IMU Sensor Configuration"}),"\n",(0,o.jsx)(e.p,{children:"Add IMU sensor to your robot model:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'\x3c!-- IMU sensor in URDF --\x3e\n<gazebo reference="imu_link">\n  <sensor name="imu_sensor" type="imu">\n    <always_on>true</always_on>\n    <update_rate>100</update_rate>\n    <imu>\n      <angular_velocity>\n        <x>\n          <noise type="gaussian">\n            <mean>0.0</mean>\n            <stddev>2e-4</stddev>\n          </noise>\n        </x>\n        <y>\n          <noise type="gaussian">\n            <mean>0.0</mean>\n            <stddev>2e-4</stddev>\n          </noise>\n        </y>\n        <z>\n          <noise type="gaussian">\n            <mean>0.0</mean>\n            <stddev>2e-4</stddev>\n          </noise>\n        </z>\n      </angular_velocity>\n      <linear_acceleration>\n        <x>\n          <noise type="gaussian">\n            <mean>0.0</mean>\n            <stddev>1.7e-2</stddev>\n          </noise>\n        </x>\n        <y>\n          <noise type="gaussian">\n            <mean>0.0</mean>\n            <stddev>1.7e-2</stddev>\n          </noise>\n        </y>\n        <z>\n          <noise type="gaussian">\n            <mean>0.0</mean>\n            <stddev>1.7e-2</stddev>\n          </noise>\n        </z>\n      </linear_acceleration>\n    </imu>\n  </sensor>\n</gazebo>\n'})}),"\n",(0,o.jsx)(e.h3,{id:"lidar-sensor-configuration",children:"LiDAR Sensor Configuration"}),"\n",(0,o.jsx)(e.p,{children:"Add 3D LiDAR sensor:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'\x3c!-- LiDAR sensor in URDF --\x3e\n<gazebo reference="lidar_link">\n  <sensor name="lidar_sensor" type="ray">\n    <always_on>true</always_on>\n    <visualize>true</visualize>\n    <update_rate>10</update_rate>\n    <ray>\n      <scan>\n        <horizontal>\n          <samples>720</samples>\n          <resolution>1</resolution>\n          <min_angle>-3.14159</min_angle>\n          <max_angle>3.14159</max_angle>\n        </horizontal>\n        <vertical>\n          <samples>16</samples>\n          <resolution>1</resolution>\n          <min_angle>-0.2618</min_angle>\n          <max_angle>0.2618</max_angle>\n        </vertical>\n      </scan>\n      <range>\n        <min>0.1</min>\n        <max>30.0</max>\n        <resolution>0.01</resolution>\n      </range>\n    </ray>\n    <plugin name="lidar_controller" filename="libgazebo_ros_ray_sensor.so">\n      <ros>\n        <namespace>/laser</namespace>\n        <remapping>~/out:=scan</remapping>\n      </ros>\n      <output_type>sensor_msgs/LaserScan</output_type>\n      <frame_name>lidar_link</frame_name>\n    </plugin>\n  </sensor>\n</gazebo>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"control-system-integration",children:"Control System Integration"}),"\n",(0,o.jsx)(e.h3,{id:"basic-control-node",children:"Basic Control Node"}),"\n",(0,o.jsx)(e.p,{children:"Create a basic control node to interface with the simulated robot:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"#!/usr/bin/env python3\n# control_node.py\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Float64MultiArray\nfrom sensor_msgs.msg import JointState\nfrom geometry_msgs.msg import Twist\nimport numpy as np\n\nclass HumanoidController(Node):\n    def __init__(self):\n        super().__init__('humanoid_controller')\n\n        # Declare parameters\n        self.declare_parameter('control_frequency', 100)\n        self.declare_parameter('robot_prefix', 'humanoid_robot')\n\n        # Get parameters\n        self.control_frequency = self.get_parameter('control_frequency').value\n        self.robot_prefix = self.get_parameter('robot_prefix').value\n\n        # Publishers for joint commands\n        self.joint_cmd_pub = self.create_publisher(\n            Float64MultiArray,\n            f'/{self.robot_prefix}/joint_group_position_controller/commands',\n            10\n        )\n\n        # Subscribers for sensor data\n        self.joint_state_sub = self.create_subscription(\n            JointState,\n            f'/{self.robot_prefix}/joint_states',\n            self.joint_state_callback,\n            10\n        )\n\n        # Timer for control loop\n        self.control_timer = self.create_timer(\n            1.0 / self.control_frequency,\n            self.control_loop\n        )\n\n        # Robot state\n        self.joint_states = None\n        self.target_positions = [0.0] * 12  # Default to 12 joints\n\n        self.get_logger().info('Humanoid Controller initialized')\n\n    def joint_state_callback(self, msg):\n        \"\"\"Update joint state from simulation.\"\"\"\n        self.joint_states = msg\n\n    def control_loop(self):\n        \"\"\"Main control loop.\"\"\"\n        if self.joint_states is not None:\n            # Generate control commands based on current state\n            cmd_msg = Float64MultiArray()\n            cmd_msg.data = self.target_positions  # Simple position control\n            self.joint_cmd_pub.publish(cmd_msg)\n\n    def set_target_positions(self, positions):\n        \"\"\"Set target joint positions.\"\"\"\n        self.target_positions = positions\n\ndef main(args=None):\n    rclpy.init(args=args)\n    controller = HumanoidController()\n\n    # Example: Move to calibration position\n    calibration_pos = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n    controller.set_target_positions(calibration_pos)\n\n    try:\n        rclpy.spin(controller)\n    except KeyboardInterrupt:\n        controller.get_logger().info('Controller stopped by user')\n    finally:\n        controller.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,o.jsx)(e.h2,{id:"physics-configuration",children:"Physics Configuration"}),"\n",(0,o.jsx)(e.h3,{id:"world-file-configuration",children:"World File Configuration"}),"\n",(0,o.jsx)(e.p,{children:"Create a Gazebo world file with appropriate physics settings:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.7">\n  <world name="humanoid_world">\n    \x3c!-- Physics engine configuration --\x3e\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n      <ode>\n        <solver>\n          <type>quick</type>\n          <iters>10</iters>\n          <sor>1.3</sor>\n        </solver>\n        <constraints>\n          <cfm>0.0</cfm>\n          <erp>0.2</erp>\n          <contact_max_correcting_vel>100.0</contact_max_correcting_vel>\n          <contact_surface_layer>0.001</contact_surface_layer>\n        </constraints>\n      </ode>\n    </physics>\n\n    \x3c!-- Ground plane --\x3e\n    <include>\n      <uri>model://ground_plane</uri>\n    </include>\n\n    \x3c!-- Lighting --\x3e\n    <include>\n      <uri>model://sun</uri>\n    </include>\n\n    \x3c!-- Your robot model will be spawned here --\x3e\n  </world>\n</sdf>\n'})}),"\n",(0,o.jsx)(e.h2,{id:"validation-and-testing",children:"Validation and Testing"}),"\n",(0,o.jsx)(e.h3,{id:"simulation-validation-node",children:"Simulation Validation Node"}),"\n",(0,o.jsx)(e.p,{children:"Create a validation node to assess simulation quality:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"#!/usr/bin/env python3\n# validation_node.py\n\nimport rclpy\nfrom rclpy.node import Node\nfrom gazebo_msgs.srv import GetModelState\nfrom sensor_msgs.msg import JointState, Imu\nfrom std_msgs.msg import Float64MultiArray\nimport numpy as np\nimport time\n\nclass SimulationValidator(Node):\n    def __init__(self):\n        super().__init__('simulation_validator')\n\n        # Declare parameters\n        self.declare_parameter('validation_frequency', 10.0)\n        self.declare_parameter('validation_threshold', 0.9)\n\n        # Get parameters\n        self.validation_frequency = self.get_parameter('validation_frequency').value\n        self.validation_threshold = self.get_parameter('validation_threshold').value\n\n        # Gazebo services\n        self.get_state_client = self.create_client(\n            GetModelState,\n            '/gazebo/get_model_state'\n        )\n\n        # Subscribers\n        self.joint_state_sub = self.create_subscription(\n            JointState,\n            '/joint_states',\n            self.joint_state_callback,\n            10\n        )\n\n        self.imu_sub = self.create_subscription(\n            Imu,\n            '/imu/data',\n            self.imu_callback,\n            10\n        )\n\n        # Publishers\n        self.validation_pub = self.create_publisher(\n            Float64MultiArray,\n            '/simulation_validation',\n            10\n        )\n\n        # Timers\n        self.validation_timer = self.create_timer(\n            1.0 / self.validation_frequency,\n            self.validation_callback\n        )\n\n        # State tracking\n        self.joint_states = None\n        self.imu_data = None\n        self.last_validation_time = time.time()\n\n        self.get_logger().info('Simulation Validator initialized')\n\n    def joint_state_callback(self, msg):\n        self.joint_states = msg\n\n    def imu_callback(self, msg):\n        self.imu_data = msg\n\n    def validation_callback(self):\n        \"\"\"Perform validation checks.\"\"\"\n        if self.joint_states is None or self.imu_data is None:\n            return\n\n        # Calculate validation metrics\n        metrics = self.calculate_validation_metrics()\n\n        # Publish results\n        result_msg = Float64MultiArray()\n        result_msg.data = [\n            metrics['stability_score'],\n            metrics['kinematic_consistency'],\n            metrics['sensor_accuracy'],\n            metrics['overall_score']\n        ]\n        self.validation_pub.publish(result_msg)\n\n        # Log status periodically\n        current_time = time.time()\n        if current_time - self.last_validation_time > 5.0:\n            self.get_logger().info(\n                f'Validation - Stability: {metrics[\"stability_score\"]:.3f}, '\n                f'Kinematic: {metrics[\"kinematic_consistency\"]:.3f}, '\n                f'Overall: {metrics[\"overall_score\"]:.3f}'\n            )\n            self.last_validation_time = current_time\n\n    def calculate_validation_metrics(self):\n        \"\"\"Calculate various validation metrics.\"\"\"\n        metrics = {}\n\n        # Stability score based on joint positions\n        if self.joint_states:\n            # Check for extreme joint positions\n            extreme_count = 0\n            for pos in self.joint_states.position:\n                if abs(pos) > 3.14:  # More than 180 degrees\n                    extreme_count += 1\n\n            metrics['stability_score'] = max(0.0, 1.0 - (extreme_count / len(self.joint_states.position)))\n        else:\n            metrics['stability_score'] = 1.0\n\n        # Kinematic consistency\n        metrics['kinematic_consistency'] = 0.95  # Placeholder\n\n        # Sensor accuracy (simplified)\n        metrics['sensor_accuracy'] = 0.98  # Placeholder\n\n        # Overall score\n        metrics['overall_score'] = (\n            metrics['stability_score'] * 0.4 +\n            metrics['kinematic_consistency'] * 0.3 +\n            metrics['sensor_accuracy'] * 0.3\n        )\n\n        return metrics\n\ndef main(args=None):\n    rclpy.init(args=args)\n    validator = SimulationValidator()\n\n    try:\n        rclpy.spin(validator)\n    except KeyboardInterrupt:\n        validator.get_logger().info('Validator stopped by user')\n    finally:\n        validator.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,o.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,o.jsx)(e.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Robot falls through the ground"}),": Check inertial properties and collision geometries"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Joint oscillation"}),": Adjust physics solver parameters and joint damping"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Control lag"}),": Increase control frequency or optimize communication"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Sensor noise"}),": Verify sensor configuration parameters"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Performance issues"}),": Reduce update rates or simplify models"]}),"\n"]}),"\n",(0,o.jsx)(e.h3,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Use appropriate solver types (quick vs iterative)"}),"\n",(0,o.jsx)(e.li,{children:"Adjust step size based on required accuracy"}),"\n",(0,o.jsx)(e.li,{children:"Optimize collision geometries (simplified for simulation)"}),"\n",(0,o.jsx)(e.li,{children:"Use level-of-detail (LOD) for complex models"}),"\n",(0,o.jsx)(e.li,{children:"Monitor and limit update rates"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Modular Design"}),": Keep URDF, controllers, and launch files organized"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Parameter Configuration"}),": Use launch parameters for flexibility"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Validation"}),": Implement validation nodes to assess simulation quality"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Documentation"}),": Document all configuration parameters"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Testing"}),": Create automated tests for simulation behavior"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Version Control"}),": Track simulation configurations in version control"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,o.jsx)(e.p,{children:"After implementing this basic integration, consider:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Advanced sensor simulation (force/torque sensors, cameras)"}),"\n",(0,o.jsx)(e.li,{children:"Multi-robot simulation scenarios"}),"\n",(0,o.jsx)(e.li,{children:"Physics parameter optimization"}),"\n",(0,o.jsx)(e.li,{children:"Sim-to-real transfer validation"}),"\n",(0,o.jsx)(e.li,{children:"Advanced control strategies implementation"}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},8453(n,e,i){i.d(e,{R:()=>s,x:()=>a});var o=i(6540);const t={},r=o.createContext(t);function s(n){const e=o.useContext(r);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);